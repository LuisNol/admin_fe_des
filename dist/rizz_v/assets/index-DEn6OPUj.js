import{h as Y,j as ee,r,w as F,Q as te,l as I,m as a,q as _,t as l,L as ae,v as le,R as oe,N as se,S as ne,J as i,D as y,u as R,M as re,y as o,E as ue,x as ie,B as C,G as ce,F as de,a4 as _e,a8 as fe,a9 as me,aa as ve,a7 as pe,H as k,a5 as ge,a1 as be}from"./index-eclJbsFb.js";import{_ as he}from"./DefaultLayout.vue_vue_type_script_setup_true_lang-ClxV1K4K.js";import{H as A}from"./http-client-BDz097Pl.js";import{S as b}from"./sweetalert2-kDq5VRxw.js";import"./logo-sm-CPlBPHhB.js";const ye=o("i",{class:"far fa-plus-square ml-3"},null,-1),ke=o("i",{class:"fas fa-search"},null,-1),Ce=o("i",{class:"fas fa-sync"},null,-1),xe={class:"table-responsive m-0"},we={class:"table datatable",id:"datatable_1"},Ee=o("thead",{class:"table-light"},[o("tr",null,[o("th",null,"Id"),o("th",null,"Categoria"),o("th",null,"Estado"),o("th",null,"Fecha R."),o("th",null,"Acciones")])],-1),Ve=["src"],Ie={class:"mx-2"},Ae=["onClick"],Ne=o("i",{class:"las la-pen text-secondary fs-22"},null,-1),Re=[Ne],Ue=["onClick"],Se=o("i",{class:"las la-trash-alt text-secondary fs-22"},null,-1),Be=[Se],Pe=o("label",{for:"categorie",class:"col-form-label text-lg-end"},"Nombre del Categoria",-1),$e=o("label",{for:"avatar-user",class:"col-form-label text-lg-end"},"Avatar de Usuario: ",-1),De=["src"],Fe=o("label",{for:"state-categorie",class:"col-form-label text-lg-end"},"Estado: ",-1),Ge={class:"modal-footer"},qe=Y({__name:"index",setup(Le){const N=ee(),p=r([]),g=r(""),f=r(1),m=r(!1),U=r("primary"),d=r(),x=r(1),S=r(0),B=r(1),w=r(""),h=r(null),v=r(null),E=async()=>{try{const t=await A.get("categories?page="+x.value+"&search="+(w.value??""));console.log(t),p.value=t.data.categories,S.value=t.data.total,B.value=t.data.pagination}catch(t){console.log(t)}},G=()=>{w.value="",E()},L=t=>{if(t.target.files[0].type.indexOf("image")<0){h.value=null,v.value=null,b.fire("Upps!","SOLAMENTE PUEDEN SER ARCHIVOS DE TIPO IMAGEN","error");return}v.value=t.target.files[0];let e=new FileReader;v.value&&(e.readAsDataURL(v.value),e.onloadend=()=>h.value=e.result)},M=async()=>{try{if(!g.value){b.fire("Upps!","El campo nombre es obligatorio","error");return}if(!d&&!v.value){b.fire("Upps!","El campo imagen es obligatorio","error");return}let t=new FormData;t.append("title",g.value),t.append("state",f.value+""),v.value&&t.append("image",v.value);let e;if(d.value?e=await A.post("categories/"+d.value.id,t):e=await A.post("categories",t),console.log(e),e.data.code==405)b.fire("Upps!",e.data.message,"error");else{if(d.value){let u=p.value.findIndex(n=>{var c;return n.id==((c=d.value)==null?void 0:c.id)});u!=-1&&(p.value[u]=e.data.categorie)}else p.value.unshift(e.data.categorie);m.value=!1,g.value="",f.value=1,b.fire("Genial!",e.data.message,"success")}}catch(t){console.log(t)}},H=async t=>{b.fire({title:"Confirmar la eliminaciÃ³n",text:"Â¿Estas seguro de eliminar esta categoria ''"+t.name+"'' ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminalo!"}).then(async e=>{if(e.isConfirmed)try{const u=await A.delete("categories/"+t.id);console.log(u),b.fire("Genial!",u.data.message,"success");let n=p.value.findIndex(c=>c.id==t.id);n!=-1&&p.value.splice(n,1)}catch(u){console.log(u)}})},j=t=>{m.value=!0,g.value=t.title,d.value=t,f.value=t.state,h.value=t.imagen};return F(m,t=>{t==!1&&(d.value=void 0,g.value="",f.value=1,h.value="",v.value=null)}),F(x,t=>{E()}),te(()=>{E()}),(t,e)=>{const u=ne,n=ae,c=re,V=se,P=ue,O=oe,$=be,T=ie,q=le,Z=_e,z=me,J=ve,Q=fe,D=pe,K=ge;return _(),I(he,null,{default:a(()=>[l(V,{class:"justify-content-center"},{default:a(()=>[l(n,{cols:"12"},{default:a(()=>[l(q,{"no-body":""},{default:a(()=>[l(O,null,{default:a(()=>[l(V,{class:"align-items-center justify-content-between"},{default:a(()=>[l(n,{lg:"3"},{default:a(()=>[l(u,null,{default:a(()=>[i("ðŸ§® Categories")]),_:1})]),_:1}),l(n,{lg:"2"},{default:a(()=>[R(N).isPermitedRoute("register_categorie")?(_(),I(c,{key:0,type:"button",variant:"success",onClick:e[0]||(e[0]=s=>m.value=!m.value)},{default:a(()=>[ye,i(" Registrar ")]),_:1})):y("",!0)]),_:1})]),_:1}),l(V,{class:"align-items-center justify-content-between"},{default:a(()=>[l(n,{lg:"5"},{default:a(()=>[l(P,{type:"text",id:"role",modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=s=>w.value=s),placeholder:"Buscar por nombre"},null,8,["modelValue"])]),_:1}),l(n,{lg:"3",md:"3"},{default:a(()=>[l(c,{type:"button",onClick:E,variant:"success"},{default:a(()=>[ke]),_:1}),l(c,{type:"button",onClick:G,variant:"dark",class:"mx-2"},{default:a(()=>[Ce]),_:1})]),_:1})]),_:1})]),_:1}),l(T,{class:"pt-0"},{default:a(()=>[o("div",xe,[o("table",we,[Ee,o("tbody",null,[(_(!0),C(de,null,ce(p.value,(s,W)=>(_(),C("tr",{key:W},[o("td",null,k(s.id),1),o("td",null,[o("img",{src:s.imagen,width:"32",alt:""},null,8,Ve),o("span",Ie,k(s.title),1)]),o("td",null,[s.state==1?(_(),I($,{key:0,variant:"primary"},{default:a(()=>[i("Activo")]),_:1})):y("",!0),s.state==2?(_(),I($,{key:1,variant:"danger"},{default:a(()=>[i("Inactivo")]),_:1})):y("",!0)]),o("td",null,k(s.created_at),1),o("td",null,[R(N).isPermitedRoute("edit_categorie")?(_(),C("a",{key:0,href:"#",onclick:"return false;",onClick:X=>j(s)},Re,8,Ae)):y("",!0),i(k(" ")+" "),R(N).isPermitedRoute("delete_categorie")?(_(),C("a",{key:1,href:"#",onclick:"return false;",onClick:X=>H(s)},Be,8,Ue)):y("",!0)])]))),128))])])])]),_:1})]),_:1}),l(Z,{modelValue:x.value,"onUpdate:modelValue":e[2]||(e[2]=s=>x.value=s),"total-rows":S.value,"per-page":B.value,"prev-text":"Previous","next-text":"Next"},null,8,["modelValue","total-rows","per-page"])]),_:1})]),_:1}),l(K,{modelValue:m.value,"onUpdate:modelValue":e[8]||(e[8]=s=>m.value=s),title:`ðŸ” ${d.value?"Editar":"Registrar"} un Categoria`,"header-class":`bg-${U.value}`,"title-class":"m-0 text-white","ok-title":"Save changes","ok-variant":U.value,"cancel-title":"Close",centered:"","hide-footer":"",size:"md"},{default:a(()=>[l(V,null,{default:a(()=>[l(n,{cols:"9",class:"mb-3"},{default:a(()=>[Pe,l(P,{type:"text",id:"categorie",modelValue:g.value,"onUpdate:modelValue":e[3]||(e[3]=s=>g.value=s),placeholder:""},null,8,["modelValue"])]),_:1}),l(n,{lg:"6"},{default:a(()=>[$e,l(Q,{class:"mb-3"},{default:a(()=>[l(z,{onChange:e[4]||(e[4]=s=>L(s))}),l(J,null,{default:a(()=>[i("Upload")]),_:1})]),_:1}),h.value?(_(),C("img",{key:0,src:h.value,alt:"",width:"100px",class:"rounded d-block mx-auto"},null,8,De)):y("",!0)]),_:1}),l(n,{lg:"6"},{default:a(()=>[Fe,l(D,{name:"state-categorie",onClick:e[5]||(e[5]=s=>f.value=1),value:"1",checked:f.value==1},{default:a(()=>[i("Activo")]),_:1},8,["checked"]),i(" "+k(" ")+" "),l(D,{name:"state-categorie",onClick:e[6]||(e[6]=s=>f.value=2),value:"2",checked:f.value==2},{default:a(()=>[i("Inactivo")]),_:1},8,["checked"])]),_:1}),l(n,{lg:"12",class:"mt-3"},{default:a(()=>[o("div",Ge,[l(c,{type:"button",variant:"secondary",onClick:e[7]||(e[7]=s=>m.value=!1)},{default:a(()=>[i(" Cerrar ")]),_:1}),l(c,{type:"button",variant:"primary",onClick:M},{default:a(()=>[i(k(d.value?"Editar":"Guardar"),1)]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue","title","header-class","ok-variant"])]),_:1})}}});export{qe as default};
