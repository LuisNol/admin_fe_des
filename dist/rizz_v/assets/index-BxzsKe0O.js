import{h as re,r as u,w as de,P as ie,l as ce,m as n,q as I,t as a,L as me,v as pe,S as _e,N as ve,T as fe,J as i,M as ge,y as t,E as be,x as he,s as Ee,B as N,G as J,F as j,a4 as xe,a6 as ye,a7 as Ve,H as r,D as Ae,a8 as Ce,a9 as ke,aa as Ue,a5 as Ie}from"./index-gVDBkDDG.js";import{_ as Te}from"./DefaultLayout.vue_vue_type_script_setup_true_lang-BCVk1Efs.js";import{H as M}from"./http-client-BDz097Pl.js";import{S as c}from"./sweetalert2-q9Q5VRHP.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Ne=t("i",{class:"far fa-plus-square ml-3"},null,-1),Re=t("i",{class:"fas fa-search"},null,-1),we=t("i",{class:"fas fa-sync"},null,-1),De={class:"table-responsive m-0"},Me={class:"table datatable",id:"datatable_1"},Oe={class:"table-light"},Pe=t("th",null,"ID",-1),Le=t("th",null,"NOMBRE Y APELLIDO",-1),Fe=t("th",null,"EMAIL",-1),Se=t("th",null,"PHONE",-1),Be=t("th",null,"TIPO DOCUMENTO",-1),$e=t("th",null,"N DE DOCUMENTO",-1),He=t("th",null,"ROLE",-1),Ge=t("th",null,"F.REGISTRO",-1),Je={class:"d-flex align-items-center"},je={class:"thumb-md justify-content-center d-flex align-items-center bg-purple-subtle text-purple rounded-circle me-2"},qe=["onClick"],Xe=t("i",{class:"las la-pen text-secondary fs-22"},null,-1),Ze=[Xe],ze=["onClick"],Ye=t("i",{class:"las la-trash-alt text-secondary fs-22"},null,-1),Ke=[Ye],Qe=t("label",{for:"name-user",class:"col-form-label text-lg-end"},"Nombre: ",-1),We=t("label",{for:"surname-user",class:"col-form-label text-lg-end"},"Apellido: ",-1),el=t("label",{for:"email-user",class:"col-form-label text-lg-end"},"Email: ",-1),ll=t("label",{for:"phone-user",class:"col-form-label text-lg-end"},"Telefono: ",-1),al=t("label",{for:"role_user",class:"col-form-label text-lg-end"},"Role: ",-1),tl=["value"],ol=t("label",{for:"type-document-user",class:"col-form-label text-lg-end"},"Tipo de documento: ",-1),nl=t("option",{value:"DNI"},"DNI",-1),sl=t("option",{value:"PASAPORTE"},"PASAPORTE",-1),ul=t("option",{value:"CARNET DE EXTRANJERIA"},"CARNET DE EXTRANJERIA",-1),rl=t("option",{value:"TARJETA MILITAR"},"TARJETA MILITAR",-1),dl=t("label",{for:"n_document-user",class:"col-form-label text-lg-end"},"N춿 de Documento: ",-1),il=t("label",{for:"gender-user",class:"col-form-label text-lg-end"},"Genero: ",-1),cl=t("label",{for:"state-user",class:"col-form-label text-lg-end"},"Estado: ",-1),ml=t("label",{for:"password-user",class:"col-form-label text-lg-end"},"Contrase침a: ",-1),pl=t("label",{for:"avatar-user",class:"col-form-label text-lg-end"},"Avatar de Usuario: ",-1),_l=["src"],vl={class:"modal-footer"},yl=re({__name:"index",setup(fl){const f=u([]),g=u(""),x=u(""),y=u(""),V=u(""),T=u("DNI"),A=u(),C=u(),b=u("M"),k=u("1"),_=u(1),F=u([]),U=u(null),v=u(null),h=u(!1),S=u("primary"),m=u(),O=u(1),B=u(0),$=u(1),R=u(""),P=async()=>{try{const l=await M.get("users?page="+O.value+"&search="+(R.value??""));console.log(l),f.value=l.data.users.data,F.value=l.data.roles,B.value=l.data.total,$.value=l.data.pagination}catch(l){console.log(l)}},q=()=>{R.value="",P()},X=async()=>{try{if(!g.value){c.fire("Upps!","El campo nombre es obligatorio","error");return}if(!x.value){c.fire("Upps!","El campo apellido es obligatorio","error");return}if(!y.value){c.fire("Upps!","El campo email es obligatorio","error");return}if(!C.value){c.fire("Upps!","El campo telefono es obligatorio","error");return}if(!A.value){c.fire("Upps!","El campo numero de documento es obligatorio","error");return}if(!m.value&&!V.value){c.fire("Upps!","El campo contrase침a es obligatorio","error");return}if(!k.value){c.fire("Upps!","El campo role es obligatorio","error");return}if(!m.value&&!v.value){c.fire("Upps!","El campo avatar es obligatorio","error");return}let l=new FormData;l.append("name",g.value),l.append("surname",x.value),l.append("email",y.value),l.append("phone",C.value+""),l.append("role_id",k.value+""),l.append("type_document",T.value),l.append("n_document",A.value+""),V.value&&l.append("password",V.value),l.append("gender",b.value),l.append("state",_.value+""),v.value&&l.append("imagen",v.value);let e;if(m.value?e=await M.post("users/"+m.value.id,l):e=await M.post("users",l),console.log(e),e.data.code==405)c.fire("Upps!",e.data.message,"error");else{if(m.value&&e.data.user){let d=f.value.findIndex(s=>{var p;return s.id==((p=m.value)==null?void 0:p.id)});d!=-1&&(f.value[d]=e.data.user)}else e.data.user&&(f.value.unshift(e.data.user),H());h.value=!1,g.value="",c.fire("Genial!",e.data.message,"success")}}catch(l){console.log(l)}},Z=l=>{if(l.target.files[0].type.indexOf("image")<0){U.value=null,v.value=null,c.fire("Upps!","SOLAMENTE PUEDEN SER ARCHIVOS DE TIPO IMAGEN","error");return}v.value=l.target.files[0];let e=new FileReader;v.value&&(e.readAsDataURL(v.value),e.onloadend=()=>U.value=e.result)},z=async l=>{c.fire({title:"Confirmar la eliminaci칩n",text:"쮼stas seguro de eliminar este usuario ''"+l.name+"'' ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminalo!"}).then(async e=>{if(e.isConfirmed)try{const d=await M.delete("users/"+l.id);console.log(d),c.fire("Genial!",d.data.message,"success");let s=f.value.findIndex(p=>p.id==l.id);s!=-1&&f.value.splice(s,1)}catch(d){console.log(d)}})},Y=l=>{h.value=!0,g.value=l.name,x.value=l.surname??"",y.value=l.email,C.value=l.phone,_.value=l.state,U.value=l.avatar,v.value=null,T.value=l.type_document??"",A.value=l.n_document,b.value=l.gender,_.value=l.state,k.value=l.role_id,m.value=l},K=l=>l?l.split(" ").map(d=>d.charAt(0).toUpperCase()).join(""):"",H=()=>{g.value="",x.value="",y.value="",C.value=0,_.value=1,U.value="",v.value=null,T.value="",A.value=0,b.value="",_.value=1,V.value="",k.value=""};return de(h,l=>{l==!1&&(m.value=void 0,H())}),ie(()=>{P()}),(l,e)=>{const d=fe,s=me,p=ge,w=ve,E=be,Q=_e,W=Ee("TH"),ee=he,le=pe,ae=xe,G=ye,D=Ve,te=ke,oe=Ue,ne=Ce,se=Ie;return I(),ce(Te,null,{default:n(()=>[a(w,{class:"justify-content-center"},{default:n(()=>[a(s,{cols:"12"},{default:n(()=>[a(le,{"no-body":""},{default:n(()=>[a(Q,null,{default:n(()=>[a(w,{class:"align-items-center justify-content-between"},{default:n(()=>[a(s,{lg:"3"},{default:n(()=>[a(d,null,{default:n(()=>[i("游누 Usuarios")]),_:1})]),_:1}),a(s,{lg:"2"},{default:n(()=>[a(p,{type:"button",variant:"success",onClick:e[0]||(e[0]=o=>h.value=!h.value)},{default:n(()=>[Ne,i(" Registrar ")]),_:1})]),_:1})]),_:1}),a(w,{class:"align-items-center justify-content-between"},{default:n(()=>[a(s,{lg:"5"},{default:n(()=>[a(E,{type:"text",modelValue:R.value,"onUpdate:modelValue":e[1]||(e[1]=o=>R.value=o),placeholder:"Buscar por usuario"},null,8,["modelValue"])]),_:1}),a(s,{lg:"3",md:"3"},{default:n(()=>[a(p,{type:"button",onClick:P,variant:"success"},{default:n(()=>[Re]),_:1}),a(p,{type:"button",onClick:q,variant:"dark",class:"mx-2"},{default:n(()=>[we]),_:1})]),_:1})]),_:1})]),_:1}),a(ee,{class:"pt-0"},{default:n(()=>[t("div",De,[t("table",Me,[t("thead",Oe,[t("tr",null,[Pe,Le,Fe,Se,Be,$e,He,Ge,a(W,null,{default:n(()=>[i("ACCI칍N")]),_:1})])]),t("tbody",null,[(I(!0),N(j,null,J(f.value,(o,L)=>(I(),N("tr",{key:L},[t("td",null,r(o.id),1),t("td",null,[t("div",Je,[t("span",je,r(K(o.full_name)),1),t("span",null,r(o.full_name),1)])]),t("td",null,r(o.email),1),t("td",null,r(o.phone),1),t("td",null,r(o.type_document),1),t("td",null,r(o.n_document),1),t("td",null,r(o.role.name),1),t("td",null,r(o.created_at),1),t("td",null,[t("a",{href:"#",onclick:"return false;",onClick:ue=>Y(o)},Ze,8,qe),i(r(" ")+" "),t("a",{href:"#",onclick:"return false;",onClick:ue=>z(o)},Ke,8,ze)])]))),128))])])])]),_:1})]),_:1}),a(ae,{modelValue:O.value,"onUpdate:modelValue":e[2]||(e[2]=o=>O.value=o),"total-rows":B.value,"per-page":$.value,"prev-text":"Previous","next-text":"Next"},null,8,["modelValue","total-rows","per-page"])]),_:1})]),_:1}),a(se,{modelValue:h.value,"onUpdate:modelValue":e[16]||(e[16]=o=>h.value=o),title:`游댏 ${m.value?"Editar":"Registrar"} un Usuario`,"header-class":`bg-${S.value}`,"title-class":"m-0 text-white","ok-title":"Save changes","ok-variant":S.value,"cancel-title":"Close",centered:"","hide-footer":"",size:"lg"},{default:n(()=>[a(w,null,{default:n(()=>[a(s,{lg:"5"},{default:n(()=>[Qe,a(E,{type:"text",id:"name-user",modelValue:g.value,"onUpdate:modelValue":e[3]||(e[3]=o=>g.value=o),placeholder:"Example: Jose"},null,8,["modelValue"])]),_:1}),a(s,{lg:"5"},{default:n(()=>[We,a(E,{type:"text",id:"surname-user",modelValue:x.value,"onUpdate:modelValue":e[4]||(e[4]=o=>x.value=o),placeholder:"Example: Jose"},null,8,["modelValue"])]),_:1}),a(s,{lg:"4"},{default:n(()=>[el,a(E,{type:"text",id:"email-user",modelValue:y.value,"onUpdate:modelValue":e[5]||(e[5]=o=>y.value=o),placeholder:"Example: nolberto.sumaran@gmail.com"},null,8,["modelValue"])]),_:1}),a(s,{lg:"4"},{default:n(()=>[ll,a(E,{type:"number",id:"phone-user",modelValue:C.value,"onUpdate:modelValue":e[6]||(e[6]=o=>C.value=o),placeholder:"Example: nolberto.sumaran@gmail.com"},null,8,["modelValue"])]),_:1}),a(s,{lg:"4"},{default:n(()=>[al,a(G,{id:"type_document_list",modelValue:k.value,"onUpdate:modelValue":e[7]||(e[7]=o=>k.value=o)},{default:n(()=>[(I(!0),N(j,null,J(F.value,(o,L)=>(I(),N("option",{key:L,value:o.id},r(o.name),9,tl))),128))]),_:1},8,["modelValue"])]),_:1}),a(s,{lg:"4"},{default:n(()=>[ol,a(G,{id:"type_document_list",modelValue:T.value,"onUpdate:modelValue":e[8]||(e[8]=o=>T.value=o)},{default:n(()=>[nl,sl,ul,rl]),_:1},8,["modelValue"])]),_:1}),a(s,{lg:"4"},{default:n(()=>[dl,a(E,{type:"number",id:"n_document-user",modelValue:A.value,"onUpdate:modelValue":e[9]||(e[9]=o=>A.value=o),placeholder:"Example: #######"},null,8,["modelValue"])]),_:1}),a(s,{lg:"4"},{default:n(()=>[il,a(D,{name:"gender-user",onClick:e[10]||(e[10]=o=>b.value="M"),value:"M",checked:b.value=="M"},{default:n(()=>[i("Masculino")]),_:1},8,["checked"]),i(" "+r(" ")+" "),a(D,{name:"gender-user",onClick:e[11]||(e[11]=o=>b.value="F"),value:"F",checked:b.value=="F"},{default:n(()=>[i("Femenino")]),_:1},8,["checked"])]),_:1}),a(s,{lg:"3"},{default:n(()=>[cl,a(D,{name:"state-user",onClick:e[12]||(e[12]=o=>_.value=1),value:"1",checked:_.value==1},{default:n(()=>[i("Activo")]),_:1},8,["checked"]),i(" "+r(" ")+" "),a(D,{name:"state-user",onClick:e[13]||(e[13]=o=>_.value=2),value:"2",checked:_.value==2},{default:n(()=>[i("Inactivo")]),_:1},8,["checked"])]),_:1}),a(s,{lg:"4"},{default:n(()=>[ml,a(E,{type:"password",id:"password-user",modelValue:V.value,"onUpdate:modelValue":e[14]||(e[14]=o=>V.value=o),placeholder:"*********"},null,8,["modelValue"])]),_:1}),a(s,{lg:"5"},{default:n(()=>[pl,a(ne,{class:"mb-3"},{default:n(()=>[a(te,{onChange:e[15]||(e[15]=o=>Z(o))}),a(oe,null,{default:n(()=>[i("Upload")]),_:1})]),_:1}),U.value?(I(),N("img",{key:0,src:U.value,alt:"",width:"100px",class:"rounded d-block mx-auto"},null,8,_l)):Ae("",!0)]),_:1}),a(s,{lg:"12",class:"mt-3"},{default:n(()=>[t("div",vl,[a(p,{type:"button",variant:"secondary","data-bs-dismiss":"modal"},{default:n(()=>[i(" Cerrar ")]),_:1}),a(p,{type:"button",variant:"primary",onClick:X},{default:n(()=>[i(r(m.value?"Editar":"Crear"),1)]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue","title","header-class","ok-variant"])]),_:1})}}});export{yl as default};
